---
title: "Principal Component Analysis"
author: "Dean D'souza"
date: "`r Sys.Date()`"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(e1071)
set.seed(695949)
```

## Solutions

* Apply both methods of PCA (princomp and preProcess) to the USArrests data supplied in Moodle  

```{r,warning=FALSE,message=FALSE}
#Setting up the data
dat<-read.csv("~/PrinAn2/USArrests.csv", row.names=1) #importing into dat for convenience
# head(dat) #Commented out as not necessary
```  

  1. First, run a correlation matrix on the 4 numeric columns, and explain which you think should be removed if you were trying to predict UrbanPop from Murder, Assault, and Rape  
  
```{r,warning=FALSE,message=FALSE}
cor(dat)
```  
  
  As we can see from the above correlation matrix, 'UrbanPop' is closely related to 'Murder' and further related to 'Rape' but not that correlated to 'Assault'.

  2. Next, create scatter plots of Murder, Assault, and Rape versus UrbanPop  
  
```{r,warning=FALSE,message=FALSE,fig.height=4,fig.width=6,fig.align='center',echo=FALSE}
par(mfrow=c(1,3))

plot(dat$Murder,dat$UrbanPop,main="Murder vs. Ubran Population",xlab="Murders",ylab="Urban Population" )

plot(dat$Assault,dat$UrbanPop,main="Assault vs. Ubran Population",xlab="Assaults",ylab="Urban Population" )

plot(dat$Rape,dat$UrbanPop,main="Rape vs. Ubran Population",xlab="Rapes",ylab="Urban Population" )
```  

  3. Run PCA once on the columns Murder, Assault, and Rape using the first method described in this lecture  
  
```{r,warning=FALSE,message=FALSE}
USArrests_pca1<-princomp(~Murder+Assault+Rape+UrbanPop,data=dat)
attributes(USArrests_pca1)
USArrests_pca1$scores
USArrests_pca1
summary(USArrests_pca1)
```  

  4. Run PCA again on the columns Murder, Assault, and Rape using the second method from the caret package  
  
```{r,warning=FALSE,message=FALSE}
USArrests_pca2<-preProcess(dat,method = c("BoxCox","center","scale","pca"),thresh = 0.95)
attributes(USArrests_pca2)
summary(USArrests_pca2)
```  

  5. Be sure to create the scores from the PCA object when using the caret package method  
  
```{r,warning=FALSE,message=FALSE}
```  

  6. Explain why BoxCoc, center, and scale functions were used in the second method  



