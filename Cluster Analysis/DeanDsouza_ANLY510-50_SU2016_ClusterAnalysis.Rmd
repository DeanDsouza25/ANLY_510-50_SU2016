---
title: "Cluster Analysis"
author: "Dean D'souza"
date: "`r Sys.Date()`"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Solutions:

* Using the mtcars data set
  
  We setup the data as follows:  
  
```{r,warning=FALSE,message=FALSE}
data(mtcars)
head(mtcars)
dat<-mtcars
remove(mtcars)
set.seed(596979)
```  

* Create a kmeans object from the first, second, and third columns  
  
  We create the kmeans object after subsetting as follows:  

```{r,warning=FALSE,message=FALSE}
cars123<-mtcars[,1:3]
cars_km1<-kmeans(cars123, centers = 3)
```  

* What is the size of each cluster?  
  
  We can obtain the size of the three clusters as follows:  
  
```{r,message=FALSE,warning=FALSE}
cars_km1$size
```  

* What are the centers of each cluster?  
  
  We can obtain the centers of the clusters as follows:  

```{r,warning=FALSE,message=FALSE}
cars_km1$centers
```  

* What is the average disp, wt, and qsec of each cluster?  
  
  We obtain the details as follows:  

```{r,warning=FALSE,message=FALSE}
cars_478_avg<-aggregate(mtcars, by=list(cars_km1$cluster), FUN = mean)
cars_478_avg[,c(4,7,8)]
```

* Describe each cluster in English.   
  
  

* Find a data set with at least 4 columns of numeric data and a categorical column  
  
  For the purpose of this assignment I chose to combine the first four columns of State.x77 and the State.region data into a single data frame as follows:
    
```{r,warning=FALSE,message=FALSE}
state<-data.frame(state.x77[,1:4],state.region)
```  

* Run several scatter plots of the data  
  
```{r,warning=FALSE,message=FALSE}
par(mfrow=c(4,3))

hist(state$Population)
hist(state$Income)
hist(state$Illiteracy)
hist(state$Life.Exp)
plot(state$state.region)

plot(state$Population,state$Income,main = "Population vs. Income",xlab = "Population",ylab = "Income")
abline(lm(state$Population~state$Income), col="red")
lines(lowess(state$Population,state$Income), col="blue")

plot(state$Population,state$Illiteracy,main = "Population vs. Illiteracy rate",xlab = "Population",ylab = "Illiteracy")
abline(lm(state$Population~state$Illiteracy), col="red")
lines(lowess(state$Population,state$Illiteracy), col="blue")

plot(state$Population,state$Life.Exp,main = "Population vs. Life Expectancy",xlab = "Population",ylab = "Life Expectancy")
abline(lm(state$Population~state$Life.Exp), col="red")
lines(lowess(state$Population,state$Life.Exp), col="blue")

plot(state$Income,state$Illiteracy,main = "Income vs. Illiteracy Rate",xlab = "Income",ylab = "Illiteract Rate")
abline(lm(state$Income~state$Illiteracy), col="red")
lines(lowess(state$Income,state$Illiteracy), col="blue")

plot(state$Income,state$Life.Exp,main = "Income vs. Life Expectancy",xlab = "Income",ylab = "Life Expectancy")
abline(lm(state$Income~state$Life.Exp), col="red")
lines(lowess(state$Income,state$Life.Exp), col="blue")

plot(state$Illiteracy,state$Life.Exp,main = "Illiteracy Rate vs. Life Expectancy",xlab = "Illiteracy Rate",ylab = "Life Expectancy")
abline(lm(state$Illiteracy~state$Life.Exp), col="red")
lines(lowess(state$Illiteracy,state$Life.Exp), col="blue")
```  

* Create a kmeans object from the numeric data, you can pick K to be whatever you want  
* Determine the size of each cluster  
* Determine the centers of each cluster  
* Compare the clusters to the categorical data column as we did with the iris$Species column  
* For your chosen data set,   
  + Describe what each row of data represents  
  + Describe each of your columns used - give a one sentence description of the column  
  + If you know it, describe how the data was generated
* For the clusters  
  + Describe the size and means of clusters  
  + Give a one- or two-word description to each cluster - in other words, give each cluster a label or name  
* This is an exercise in turning your numeric data into something descriptive for non-statisticians  